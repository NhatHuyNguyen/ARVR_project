---
title: "ds3-4"
output: html_document
---

```{r}
library(tidyverse)
library(readxl)
```

```{r}
gen_filename <- "./3 - 2025-generations-aihw-suicide-and-self-harm-monitoring-age-period-cohort-analysis.xlsx"
gen_age <- read_xlsx(gen_filename, sheet="Table S1 Age", skip=1)
# reformat col names
colnames(gen_age) <- tolower(colnames(gen_age))
colnames(gen_age) <- gsub(" ", "_", colnames(gen_age))

gen_year <- read_xlsx(gen_filename, sheet="Table S2 Calendar Year", skip=1)
# reformat col names
colnames(gen_year) <- tolower(colnames(gen_year))
colnames(gen_year) <- gsub(" ", "_", colnames(gen_year))

gen_year_birth <- read_xlsx(gen_filename, sheet="Table S3 Year of Birth", skip=1)
# reformat col names
colnames(gen_year_birth) <- tolower(colnames(gen_year_birth))
colnames(gen_year_birth) <- gsub(" ", "_", colnames(gen_year_birth))
# mac <- df %>% group_by(mechanism_of_death) %>% summarise(sum(smoothed_suicide_count))
```

```{r}
lgbt_filename <- "./4 - 2019-lgbt-aihw-suicide-and-self-harm-monitoring-WTI4-supplementary-table.xlsx"

colnames_state <- c("State", "ever_n", "ever_percent", "last12_n", "last12_percent", "never_n",
                  "never_percent", "not_say_n", "not_say_percent")
lgbt_state_thoughts = read_xlsx(lgbt_filename, sheet="S1 State & Territory",
                                range="B7:J16")
colnames(lgbt_state_thoughts) <- colnames_state

lgbt_state_plans = read_xlsx(lgbt_filename, sheet="S1 State & Territory",
                                range="B19:J28")
colnames(lgbt_state_plans) <- colnames_state

lgbt_state_attempts = read_xlsx(lgbt_filename, sheet="S1 State & Territory",
                                range="B31:J40")
colnames(lgbt_state_attempts) <- colnames_state

lgbt_state_harm = read_xlsx(lgbt_filename, sheet="S1 State & Territory",
                                range="B43:J52")
colnames(lgbt_state_harm) <- colnames_state
lgbt_state_harm[lgbt_state_harm == "n.p."] <- '0'
lgbt_state_harm <- lgbt_state_harm %>%
      mutate(not_say_n = as.numeric(not_say_n)) %>%
      mutate(not_say_percent = as.numeric(not_say_percent))
```

```{r}
colnames_age <- c("Age", "ever_n", "ever_percent", "last12_n", "last12_percent", "never_n",
                  "never_percent", "not_say_n", "not_say_percent")
sheet_age = "S2 Age groups"
lgbt_age_thoughts = read_xlsx(lgbt_filename, sheet=sheet_age,
                                range="B6:J8")
colnames(lgbt_age_thoughts) <- colnames_age

lgbt_age_plans = read_xlsx(lgbt_filename, sheet=sheet_age,
                                range="B11:J13")
colnames(lgbt_age_plans) <- colnames_age

lgbt_age_attempts = read_xlsx(lgbt_filename, sheet=sheet_age,
                                range="B16:J18")
colnames(lgbt_age_attempts) <- colnames_age

lgbt_age_harm = read_xlsx(lgbt_filename, sheet=sheet_age,
                                range="B21:J23")
colnames(lgbt_age_harm) <- colnames_age
```
```{r}
colnames_gender <- c("Gender", "ever_n", "ever_percent", "last12_n", "last12_percent",
                     "never_n", "never_percent", "not_say_n", "not_say_percent")
sheet_gender = "S3 Gender"
lgbt_gender_thoughts = read_xlsx(lgbt_filename, sheet=sheet_gender,
                                range="B6:J11")
colnames(lgbt_gender_thoughts) <- colnames_gender

lgbt_gender_plans = read_xlsx(lgbt_filename, sheet=sheet_gender,
                                range="B14:J19")
colnames(lgbt_gender_plans) <- colnames_gender

lgbt_gender_attempts = read_xlsx(lgbt_filename, sheet=sheet_gender,
                                range="B22:J27")
colnames(lgbt_gender_attempts) <- colnames_gender

lgbt_gender_harm = read_xlsx(lgbt_filename, sheet=sheet_gender,
                                range="B30:J35")
colnames(lgbt_gender_harm) <- colnames_gender
```
```{r}
colnames_sexual <- c("Sexual orientation", "ever_n", "ever_percent", "last12_n",
                     "last12_percent", "never_n", "never_percent", "not_say_n",
                     "not_say_percent")
sheet_sexual = "S4 Sexual orientation"
lgbt_sexual_thoughts = read_xlsx(lgbt_filename, sheet=sheet_sexual,
                                range="B6:J13")
colnames(lgbt_sexual_thoughts) <- colnames_sexual

lgbt_sexual_plans = read_xlsx(lgbt_filename, sheet=sheet_sexual,
                                range="B17:J24")
colnames(lgbt_sexual_plans) <- colnames_sexual

lgbt_sexual_attempts = read_xlsx(lgbt_filename, sheet=sheet_sexual,
                                range="B27:J34")
colnames(lgbt_sexual_attempts) <- colnames_sexual

lgbt_sexual_harm = read_xlsx(lgbt_filename, sheet=sheet_sexual,
                                range="B38:J45")
colnames(lgbt_sexual_harm) <- colnames_sexual
```

```{r}
colnames_support_state <- c("State", "any_n", "any_percent", "in_person_n",
                     "in_person_percent", "pro_tele_n", "pro_tele_percent", "pro_text_n",
                     "pro_text_percent", "never_n", "never_percent")
sheet_sp_state = "S7 Support services s&t"
lgbt_sp_state = read_xlsx(lgbt_filename, sheet=sheet_sp_state,
                                range="B6:L15")
colnames(lgbt_sp_state) <- colnames_support_state
```

```{r}
colnames_support_age <- c("Age", "any_n", "any_percent", "in_person_n",
                     "in_person_percent", "pro_tele_n", "pro_tele_percent", "pro_text_n",
                     "pro_text_percent", "never_n", "never_percent")
sheet_sp_age = "S8 Support services age"
lgbt_sp_age = read_xlsx(lgbt_filename, sheet=sheet_sp_age,
                                range="B5:L7")
colnames(lgbt_sp_age) <- colnames_support_age
```

```{r}
colnames_support_gender <- c("Gender", "any_n", "any_percent", "in_person_n",
                     "in_person_percent", "pro_tele_n", "pro_tele_percent", "pro_text_n",
                     "pro_text_percent", "never_n", "never_percent")
sheet_sp_gender = "S9 Support services gender"
lgbt_sp_gender = read_xlsx(lgbt_filename, sheet=sheet_sp_gender,
                                range="B4:L9")
colnames(lgbt_sp_gender) <- colnames_support_gender
```

```{r}
colnames_support_sexual <- c("Sexual orientation", "any_n", "any_percent", "in_person_n",
                     "in_person_percent", "pro_tele_n", "pro_tele_percent", "pro_text_n",
                     "pro_text_percent", "never_n", "never_percent")
sheet_sp_sexual = "S10 Sup serv sexual orientation"
lgbt_sp_sexual = read_xlsx(lgbt_filename, sheet=sheet_sp_sexual,
                                range="B5:L12")
colnames(lgbt_sp_sexual) <- colnames_support_sexual
```
